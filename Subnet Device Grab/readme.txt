Creator: CaliNux
Date: 2023
Programming Language: PowerShell + Python
OS: Windows

_______________________________________________________________


This script will collect all devices and their associated IP addresses from the targets IP address. It will then store this data into a .txt file and send it to DropBox.


How to run:

1) Open "start" ps1 file in notepad.

2) Replace "YOUR-DROPBOX-API" with your DropBox api.

3) Run start


=====================================================================================================================================================================

PYTHON

=====================================================================================================================================================================
This Python script performs the following tasks:

    1) Imports necessary modules: subprocess, ipaddress, threading, socket, os, and date.


    2) Defines a function get_default_gateway(): This function uses the subprocess module to execute a PowerShell command that retrieves the default gateway IP address. It returns the IP 	address of the default gateway.


    3) Defines a function map_subnet(ip_range, output_file): This function maps the hosts within a given IP range. It uses the ipaddress module to create an IP network object from the 	ip_range argument. Then, it resolves the fully qualified domain names (FQDNs) for each host within the network. It appends the subnet information and the host information to the 	output_file in the specified format. If there is an error mapping the subnet, it writes an error message to the output_file.


    4) Defines the main function main(): This function retrieves the default gateway by calling the get_default_gateway() function. If a gateway is found, it proceeds with the following 	
	steps:

    a. Gets the hostname using the socket.gethostname() function.

    b. Retrieves the current date and formats it as "%Y-%m-%d" using date.today().strftime("%Y-%m-%d").

    c. Constructs the output file path by combining the system's temporary directory (os.environ.get('TEMP')), the hostname, and the current date.

    d. Creates a list of threads, where each thread calls the map_subnet() function with a specific IP address range and the output file path. The IP address range is generated by appending    	a number from 1 to 255 to the first three octets of the gateway IP address obtained earlier.

    e. Starts and joins each thread in the list, effectively mapping the subnets in parallel.


    5) Checks if the script is being run directly (not imported) by using if __name__ == '__main__':.


    6) Calls the main() function if the above condition is met, executing the script.


Troubleshooting-

If script is returning "0.0.0.0" as default gateway, it is highly likely the target is using a VPN.


=====================================================================================================================================================================

POWERSHELL SCRIPT

=====================================================================================================================================================================

This PowerShell script performs the following actions:

    It runs a Python script called "devicegrab.py" by executing the command "python .\devicegrab.py".
    It pauses the script execution for 20 seconds using the command "Start-Sleep -Seconds 20".
    It locates a file in the temporary folder that matches the pattern "DeviceGrabLoot*.txt" and assigns its name to the variable "$targetFileName".
    It constructs the full path of the file by joining the temporary folder path and the target file name.
    It defines a function called "DropBox-Upload" that takes a file path as input.
    Inside the "DropBox-Upload" function, it extracts the file name from the provided file path and assigns it to the variable "$outputFile".
    It constructs the target file path for uploading to Dropbox by appending a forward slash ("/") before the output file name.
    It creates the argument JSON string for the Dropbox API, specifying the target file path, upload mode, auto-rename option, and mute option.
    It sets the authorization header for the Dropbox API request using the DropBoxAccessToken variable.
    It sets the necessary headers for the API request, including the Dropbox API argument, content type, and authorization.
    It uses the "Invoke-RestMethod" cmdlet to send a POST request to the Dropbox API's file upload endpoint.
    It includes the source file in the request body using the "-InFile" parameter and passes the headers.
    Finally, it calls the "DropBox-Upload" function with the source file path as an argument to initiate the upload process.



=====================================================================================================================================================================

NOTE

=====================================================================================================================================================================

This script is for educational purposes only and as such will not clean up after the actions it does. If you use this script for evil you will get caught.
